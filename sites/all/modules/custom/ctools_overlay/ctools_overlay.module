<?php
/**
 * @file
 * Core hooks and callbacks for CTools Overlay.module
 */


/**
 * Implements hook_modal_paths().
 * @todo  add admin page to edit the paths.
 */
function ctools_overlay_modal_paths() {
  $paths = db_query('select path from {menu_router}')->fetchCol();
  $overlay_path_patterns = '
node/*
taxonomy/term/*/delete
schedulearts_clone/clone
schedulearts_clone/clone/*
schedulears_print/select-timeframe
admin/people
admin/content/*
user/*/*';

  $overlay_paths = array();
  foreach ($paths as $path) {
    if (drupal_match_path($path, $overlay_path_patterns)) {
      $overlay_paths[$path] = array();
      if (drupal_match_path($path, $redirect_paths)) {
        $overlay_paths[$path]['redirect'] = TRUE;
      }
    }
  }
  return $overlay_paths;
}

/**
 * Render the event.
 */
function ctools_overlay_fullcalendar_classes_alter(&$classes, $entity) {
  $uri = entity_uri($entity->entity_type, $entity);
  if (ctools_automodal_is_path_modal($uri['path']) && user_access('use ctools automodal')) {
    $classes[] = 'ctools-use-modal';
  }
}
